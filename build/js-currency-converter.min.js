!function(e){"use strict";e(["jquery"],function(e){return function(r){function t(r){h.isObject(r)&&(T=e.extend(T,r))}function o(){return T}function n(r,t){function o(e){h.cacheRate(i,e[i].val,new Date),c.resolve(e[i].val)}function n(e){c.reject(e)}function a(){h.setConversionInProgress(i,null)}var c=e.Deferred(),i=h.toQuery(r,t);return h.isConversionInProgress(i)?h.getConversionInProgress(i):(e.get(h.buildUrl({q:i})).done(o).fail(n).always(a),h.setConversionInProgress(i,c.promise()),c.promise())}function a(r,t){function o(e){a(!1,e)}function n(e){h.isRateCached(i)?a(!0,p[i].value):c.reject(e)}function a(e,r){c.resolve({expired:e,rate:r})}var c=e.Deferred(),i=h.toQuery(r,t);return h.isRateCachedAndNonExpired(i)?a(!1,p[i].value):h.fetchQuote(r,t).done(o).fail(n),c.promise()}function c(r,t,o){function n(e){e.value=r*e.rate,c.resolve(e)}function a(e){c.reject(e)}var c=e.Deferred();return h.getRate(t,o).done(n).fail(a),c.promise()}function i(e,r){y[e]=r}function u(e){return Boolean(h.getConversionInProgress(e))}function s(e){return y[e]}function l(e){return h.isObject(p[e])}function f(e){var r=new Date(e).getTime(),t=(new Date).getTime();return t-r>T.RATES_VALIDITY_HOURS*O}function g(e){return h.isRateCached(e)&&!h.isDateExpired(p[e].date)}function A(e,r,t){p[e]={value:r,date:t},T.CACHE_TO_LOCAL_STORAGE&&h.cacheToLocalStorage()}function d(e){return p[e]}function v(){h.setToLocalStorage(T.LOCAL_STORAGE_VARIABLE_NAME,p)}function C(){p=h.getFromLocalStorage(T.LOCAL_STORAGE_VARIABLE_NAME)}function L(e,r){return(e||"")+"_"+(r||"")}function R(e){return null!==e&&"object"==typeof e}function S(e,r){h.isLocalStorageAvailable()?localStorage.setItem(e,JSON.stringify(r)):console.error("Caching rates to local storage failed. Local storage not available")}function _(e){if(h.isLocalStorageAvailable())try{return JSON.parse(localStorage.getItem(e))||{}}catch(e){return{}}else console.error("Retrieving rates from local storage failed. Local storage not available")}function m(){var e="js-currency-test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}function E(r){var t=T.API.url+"?",o=e.extend({},T.API.queryParams,r);return e.each(o,function(e,r,o){t+=e+"="+r+"&"}),t}var O=36e5,I={RATES_VALIDITY_HOURS:24,CACHE_TO_LOCAL_STORAGE:!1,LOCAL_STORAGE_VARIABLE_NAME:"JS_CURRENCY_CONVERTER_CACHED_RATES",API:{url:"http://free.currencyconverterapi.com/api/v3/convert",queryParams:{compact:"y",apiKey:""}}},T=e.extend(!0,I,r),p={},y={},h={};return h.config=t,h.getConfig=o,h.getRate=a,h.fetchQuote=n,h.convertAmount=c,h.isConversionInProgress=u,h.setConversionInProgress=i,h.getConversionInProgress=s,h.cacheToLocalStorage=v,h.cacheFromLocalStorage=C,h.isRateCachedAndNonExpired=g,h.isRateCached=l,h.isDateExpired=f,h.cacheRate=A,h.getRateFromCache=d,h.toQuery=L,h.isObject=R,h.setToLocalStorage=S,h.getFromLocalStorage=_,h.isLocalStorageAvailable=m,h.buildUrl=E,T.CACHE_TO_LOCAL_STORAGE&&h.cacheFromLocalStorage(),h}})}("function"==typeof define&&define.amd?define:function(e,r){"undefined"!=typeof module&&module.exports?module.exports=r(require("jquery")):window.CurrencyConverter=r(window.jQuery)});